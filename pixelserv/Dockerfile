FROM python:3-alpine

RUN apk add --no-cache g++ git linux-headers make zlib-dev
RUN pip install sanic

COPY pixelsrv_libuv.py /pixelsrv.py

ENV LOGPATH "/pixelserv/access.log"
ENV HTTP_HOST "0.0.0.0"
ENV HTTPS_HOST "0.0.0.0"
ENV HTTP_PORT "8000"
ENV HTTPS_PORT "8443"

EXPOSE 8000
EXPOSE 8443

# -u: unbuffered binary stdout and stderr, stdin always buffered
# -O: optimize generated bytecode slightly
CMD python -u -O /pixelsrv.py
